# SPDX-License-Identifier: GPL-2.0-only
# Copyright (c) 2024, ByteDance Ltd. and/or its affiliates. All rights reserved.
#
# Bytedance drivers configurations
#
menu "ByteDance drivers support"

config BYTEDANCE
	bool "ByteDance private kernel drivers"
	default n
	help
	  If you want some module which belong to bytedance
	  say Y.

	  Note that the answer to this question does not directly affect the
	  kernel: saying N will just cause the configurator to skip all
	  the questions about Bytedance module. If you say Y, you will be asked
	  for your specific module in the following questions.

config BYTEDANCE_TRACE_IRQOFF
	tristate "Interrupts-off and Softirqs-off Latency Tracer"
	depends on BYTEDANCE
	default n
	help
	  This option measures the time spent in irqs-off or softirqs-off
	  critical, with microsecond accuracy.

	  The tracer is disabled by default and can be runtime (re-)started
	  via:

	      echo 1 > /proc/trace_irqoff/enable

	  The tracer only records the stack trace that irqs-off or softirqs-off
	  time exceeds the threshold and threshold can be set via:

	      # unit: microsecond
	      echo 50 > /proc/trace_irqoff/trace_latency

config BYTEDANCE_HOT_INSPECTOR
	tristate "ByteDance hot component inspector"
	depends on BYTEDANCE
	default n
	help
	  Bytedance IDC workload hot component inspector. This option launches
	  percpu timer to record hotpot in low freq.

	  You can adjust the percpu timer freq in [100, 1000000] ms via:

	      echo xxx > /sys/kernel/debug/hot_inspector/timer_ms

	  The default value is 10000ms. The percpu hotpot status are in:

	      /sys/kernel/debug/hot_inspector/cpu/[N]

config BYTEDANCE_CORE_SCHED_HELPER
	tristate "bytedance core scheduling helper"
	depends on BYTEDANCE && SCHED_CORE
	default n
	help
	  This option will give you an ioctl interface that you can use to
	  create or destroy a cookied kernel helper thread. This kernel
	  helper thread will sleeps until destroyed.

	  Bytedance TCE will use this thread to mark some threads.

config BYTEDANCE_CGV2_PERCPU_STAT
	tristate "bytedance cgroup v2 per-cpu time statistics"
	depends on BYTEDANCE && CGROUPS
	default n
	help
	  This option will provide you with 4 cgroupfs interfaces to
	  obtain the per-cpu time of cgroup v2.

	  Bytedance TCE will use these interfaces to monitor the
	  per-cpu time of the cgroup v2.

if BYTEDANCE
source "drivers/bytedance/hookbind/Kconfig"
source "drivers/bytedance/blackholefs/Kconfig"
endif

endmenu

